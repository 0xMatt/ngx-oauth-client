<!doctype html><html><head><meta charset="utf-8"><title>NgxOauthClient</title><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/x-icon" href="favicon.ico"><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"><link href="styles.2a8757c0ab45498e2d43.bundle.css" rel="stylesheet"/></head><body><header class="main-header"><a href="https://github.com/0xMatt/ngx-oauth-client" class="fork-me-badge"><img src="https://camo.githubusercontent.com/365986a132ccd6a44c23a9169022c0b5c890c387/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"></a><div class="container"><h1 class="header">ngx-oauth-client</h1><!-- Place this tag where you want the button to render. --><!-- Place this tag where you want the button to render. --> <a class="github-button" href="https://github.com/0xMatt/ngx-oauth-client" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star 0xMatt/ngx-oauth-client on GitHub">Star</a><!-- Place this tag where you want the button to render. --> <a class="github-button" href="https://github.com/0xMatt/ngx-oauth-client/fork" data-icon="octicon-repo-forked" data-size="large" data-show-count="true" aria-label="Fork 0xMatt/ngx-oauth-client on GitHub">Fork</a><!-- Place this tag where you want the button to render. --> <a class="github-button" href="https://github.com/0xMatt/ngx-oauth-client/issues" data-icon="octicon-issue-opened" data-size="large" data-show-count="true" aria-label="Issue 0xMatt/ngx-oauth-client on GitHub">Issue</a></div></header><div class="container"><main><p><a href="https://badge.fury.io/js/ngx-oauth-client"><img src="https://badge.fury.io/js/ngx-oauth-client.svg" alt="npm version"></a>
<a href="https://travis-ci.org/0xMatt/ngx-oauth-client?branch=master"><img src="https://travis-ci.org/0xMatt/ngx-oauth-client.svg" alt="Build Status"></a>
<a href="https://coveralls.io/github/0xMatt/ngx-oauth-client?branch=master"><img src="https://coveralls.io/repos/github/0xMatt/ngx-oauth-client/badge.svg?branch=master" alt="Coverage Status"></a></p>
<h1 id="ngx-oauth-client">ngx-oauth-client</h1>
<p><em>ngx-oauth-client</em> is an Angular4 HTTP/OAuth2 client utilizing the HttpClient. This package allows you to set up multiple clients to interface with many OAuth2 compliant APIs.</p>
<p>Check out the <a href="http://0xMatt.github.io/ngx-oauth-client/#demo">demo</a>!</p>
<p><a href="https://github.com/0xMatt/ngx-oauth-client/issues">Bug-reports or feature request</a> are welcome!</p>
<h2 id="getting-started">Getting started</h2>
<p>Install it via npm:</p>
<pre><code>npm install ngx-oauth-client -S
</code></pre><p>And add it as a dependency to your main module</p>
<pre><code class="lang-typescript">import {NgxOAuthModule} from &#39;ngx-oauth-client&#39;;
@NgModule({
  imports: [
    NgxOAuthModule
  ],
})
export class AppModule {
}
</code></pre>
<p>Using the library is easy, just create your extending class and configure it:</p>
<pre><code class="lang-typescript">import {NgxOAuthClient, DefaultHeaders, Configuration} from &#39;ngx-oauth-client&#39;;
@Configuration({
  host: &#39;https://jsonplaceholder.typicode.com&#39;
})
@DefaultHeaders({
  &#39;Content-Type&#39;: &#39;application/json&#39;,
  &#39;Accept&#39;: &#39;application/json&#39;
})
export class MyApiClient extends NgxOAuthClient {

}
</code></pre>
<h2 id="configuration">Configuration</h2>
<p>Configuration is done via the Configuration decorator, the api is simple</p>
<pre><code class="lang-typescript">interface NgxOAuthConfig {
  host: string;
  token?: string;
  key?: string;
  secret?: string;
  storage_prefix? string;
}
</code></pre>
<h2 id="oauth2-0">OAuth2.0</h2>
<p>Built-in support for authenticating via OAuth2 has been provided, you can use the <code>getToken</code> method to perform any authentication method to retrieve a token from the OAuth server.</p>
<p>You may use <code>fetchToken(key?)</code> to retrieve details about a specific token property or get the entire <code>NgxOAuthResponse</code> object by not supplying a value to the function parameter.</p>
<h2 id="client-credentials">Client Credentials</h2>
<pre><code class="lang-typescript">MyApiClient.getToken().subscribe((token: NgxOAuthResponse) =&gt; {
  // Token is already set for you
  MyApiClient.fetchToken(&#39;access_token&#39;); // your_token_from_response
});
</code></pre>
<h2 id="password">Password</h2>
<pre><code class="lang-typescript">MyApiClient.getToken(&#39;password&#39;, {
  username: &#39;bob&#39;,
  password: &#39;123123&#39;
}).subscribe((token: NgxOAuthResponse) =&gt; {
  // Token is already set for you
  MyApiClient.fetchToken(&#39;access_token&#39;); // your_access_token_from_response
  MyApiClient.fetchToken(&#39;refresh_token&#39;); // your_refresh_token_from_response
});
</code></pre>
<h2 id="authorization-code">Authorization Code</h2>
<pre><code class="lang-typescript">MyApiClient.getToken(&#39;authorization_code&#39;, {authorization_code: &#39;123&#39;}.subscribe((token: NgxOAuthResponse) =&gt; {
  // Token is already set for you
  MyApiClient.fetchToken(&#39;access_token&#39;); // your_access_token_from_response
  MyApiClient.fetchToken(&#39;refresh_token&#39;); // your_refresh_token_from_response
});
</code></pre>
<h2 id="interceptors">Interceptors</h2>
<p>While the HttpClient now providers interceptors, they are in fact global. Having interceptor methods allows you to have client-specific interceptor rules.</p>
<h3 id="request-interceptor">Request Interceptor</h3>
<p>The example demonstrates adding an authorization header to your requests if your criteria is met.</p>
<pre><code class="lang-typescript">requestInterceptor(request) {
    const auth = this.fetchToken();
    if (auth) {
      return request.setHeaders({Authorization: auth.token_type + auth.access_token});
    }

    return request;
}
</code></pre>
<h3 id="request-interceptor">Request Interceptor</h3>
<p>The response interceptor allows you to modify the return value from requests</p>
<pre><code class="lang-typescript">responseInterceptor(request, response) {
  return response;
}
</code></pre>
<h3 id="error-interceptor">Error Interceptor</h3>
<p>The error interceptor allows you to handle erroneous requests</p>
<pre><code class="lang-typescript">errorInterceptor(request, error): Observable&lt;any&gt; {
  if (error.status === 401) {
    const refresh_token = this.fetchToken(&#39;refresh_token&#39;);
    if (!refresh_token) {
      return Observable.throw(error);
    }
    return this.getToken(&#39;refresh_token&#39;, {refresh_token}).switchMap(token =&gt; {
      localStorage.setItem(&#39;auth_token&#39;, JSON.stringify(token));
      return this.getClient().request(
        request.method,
        request.url,
        this.requestInterceptor(request.setHeaders({Authorization: &#39;Bearer &#39; + token}))
      );
    });
  }
  return Observable.throw(error);
}
</code></pre>
<h3 id="credits">Credits</h3>
<ul>
<li><a href="http://knetikcloud.com">KnetikCloud</a> for providing the backend service that the demo utilizes</li>
<li><a href="https://github.com/johannesjo">@johannesjo</a> for his <a href="https://github.com/johannesjo/generator-angular2-lib">angular generator</a> used for building this library</li>
</ul>
<h2><a name="demo" id="demo"></a>Demo</h2><app-root>Loading...</app-root></main></div><script src="http://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script><script async defer="defer" id="github-bjs" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="inline.6031dbd50ce16d72d1cd.bundle.js"></script><script type="text/javascript" src="vendor.5715dd4233567d5218d6.bundle.js"></script><script type="text/javascript" src="main.7665a762e2d6533b6a37.bundle.js"></script></body></html>